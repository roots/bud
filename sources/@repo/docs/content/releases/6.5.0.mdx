---
slug: 6.5.0
title: 6.5.0
description: Release notes for bud.js 6.5.0
date: 2022-10-14
author: Kelly Mears
author_title: Lead developer
author_url: https://github.com/kellymears
author_image_url: https://avatars.githubusercontent.com/u/397606?v=4
tags: [release, 6.5]
---

Some much-needed filesystem functionality, post compilation tasks, and a way to upload compilations to S3.

<!--truncate-->

:::info deprecation notice

This release deprecates the `optIn` property and decorator for extensions. This doesn't matter unless you are authoring an extension. If you are, you can
probably just use `dependsOnOptional` instead.

:::

## ‚ú® bud.fs

`bud.fs` is a new filesystem API for bud.js. It uses [fs-jetpack](https://www.npmjs.com/package/fs-jetpack) and includes support for managing s3 assets.

Example of a file write operation:

```typescript
await bud.fs.write(`README.md`, `# Hello, world!`);
```

Example of the S3 API which uploads `@dist` contents to a bucket after compilation:

```typescript
bud.fs
  .setCredentials({
    accessKeyId: `***`,
    secretAccessKey: `***`,
  })
  .setEndpoint(`https://sfo2.digitaloceanspaces.com`)
  .setBucket("bud-test")
  .upload();
```

Check [the bud.fs docs](https://bud.js.org/docs/bud.fs) for more information.

## ‚ú® bud.after

Config function for executing tasks after the compilation is fully complete. This is useful for tasks that need to run after the compilation is complete, but don't need to be part of the compilation process (like uploading assets to s3!)

```typescript title="bud.config.mjs"
export default async (bud) => {
  bud.after(async (bud) => {
    await bud.fs.write(
      `dist/credits.txt`,
      `${bud.context.manifest.name} built by me!`
    );
  });
};
```

Execute a command with [bud.sh](https://bud.js.org/docs/bud.sh):

```typescript title="bud.config.mjs"
export default async (bud) => {
  bud.after(async (bud) => await bud.sh(`yarn jest`));
};
```

Check [the bud.after docs](https://bud.js.org/docs/bud.after) for more information.

## ü©π Fix: duplicative logs

Some logs would be displayed twice in the terminal if they were emitted around the same time that the dashboard was being updated.
It was also possible, depending on user configuration, for requests for the dashboard to update to fire twice. This has been fixed.

1. `console.*` events are now caught by a new service: `bud.bufferConsole`. The service catches logs, trims and deduplicates them, and
   then emits them using an instance of the standard bud logger. If bud is invoked with the `--ci` flag the service will let them pass through normally.
2. The `bud.dashboard` service's `stats` method is now debounced. Duplicative calls should be ignored.

It's likely that our handling of `process.stdout` is still imperfect, but this is a step in the right direction.

## ü©π Fix: notifications only fire once (macos)

In `dev` mode only the first compilation would result in a desktop notification. This has been fixed. You should receive a notification for every
compilation now.

## ü©π Fix: `bud.env` is not an instance of `Container`

`bud.env` was not an instance of `Container` and therefore did not have methods like `is`. This has been fixed and it should now behave as documented.

## ü©π Fix: dynamically imported chunks not hashed

Dynamically imported chunks were not being hashed. This has been fixed.

## ü©π Fix: @roots/bud-criticalcss

A breaking change in the `critical` package had broken this extension. This change has now been accounted for and the extension should work again.
This extension is still listed as experimental.

## ‚ÑπÔ∏è Release information

For more information [review the diff to see what's changed](https://github.com/roots/bud/compare/v6.4.5...v6.5.0).
