---
title: '@roots/bud-criticalcss'
description: Generate above-the-fold CSS
sidebar_label: 'ðŸŸ¡ @roots/bud-criticalcss'
---

import Tabs from '@theme/Tabs'
import TabItem from '@theme/TabItem'
import {Install} from '@site/src/docs/Install'

:::warning

This extension is experimental.

:::

[@roots/bud-criticalcss](/extensions/bud-criticalcss) generates 'above-the-fold' css from your application styles.

For more information on this technique check out this [web.dev article](https://web.dev/extract-critical-css/).

## Installation

<Install packages="@roots/bud-criticalcss" />

## Generating critical styles

Example usage:

```ts title="bud.config.mjs"
export default async bud => {
  bud.critical
    .with(1300)
    .height(900)
    .extract(true)
    .ignore({rule: [/\.editor-styles-wrapper/]})
    .src(`http://example.test`)
    .enable(bud.isProduction)
}
```

You need to do two things:

- Either:
  - specify a `src`: a URL or a path on disk to the markup that will be used to generate critical styles
  - provide `html`: the markup as a string
- Enable the extension
- Inline the generated styles

### Identify source markup

You may use `bud.critical.src` to specify a URL or a path on disk to the markup that will be used to generate critical styles.

```ts title="bud.config.mjs"
bud.critical.src(`http://example.test`)
```

```ts title="bud.config.mjs"
bud.critical.src(bud.path('path/to/index.html'))
```

Or, you may use `bud.critical.html` to provide the markup directly.

```ts title="bud.config.mjs"
bud.critical.html(`<html>...</html>`)
```

### Enable

You must explicitly call `bud.critical.enable` to enable the extension.

```ts title="bud.config.mjs"
bud.critical.enable()
```

## Add the css

The extracted styles will be emitted as a stylesheet to `@dist/critical/*.css`.

Inline the contents in the `head` of your response.

If you're using WordPress you might do something like this:

```php
  <!-- ...head -->
  <?php wp_head(); ?>
  <?php if (realpath(__DIR__ . '/public/critical/app.css')) echo "<style>" . file_get_contents(__DIR__ . '/public/critical/app.css') . "</style>"; ?>
</head>
```
