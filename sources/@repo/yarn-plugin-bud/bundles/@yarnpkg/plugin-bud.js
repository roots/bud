/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-bud",
factory: function (require) {
var plugin=(()=>{var Ki=Object.create,ht=Object.defineProperty;var Ke=Object.getOwnPropertyDescriptor;var Xi=Object.getOwnPropertyNames,Xe=Object.getOwnPropertySymbols,zi=Object.getPrototypeOf,ze=Object.prototype.hasOwnProperty,Vi=Object.prototype.propertyIsEnumerable;var Ve=(t,e,r)=>e in t?ht(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,J=(t,e)=>{for(var r in e||(e={}))ze.call(e,r)&&Ve(t,r,e[r]);if(Xe)for(var r of Xe(e))Vi.call(e,r)&&Ve(t,r,e[r]);return t};var Qi=t=>ht(t,"__esModule",{value:!0});var g=t=>{if(typeof require!="undefined")return require(t);throw new Error('Dynamic require of "'+t+'" is not supported')};var w=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Zi=(t,e)=>{for(var r in e)ht(t,r,{get:e[r],enumerable:!0})},to=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Xi(e))!ze.call(t,n)&&n!=="default"&&ht(t,n,{get:()=>e[n],enumerable:!(r=Ke(e,n))||r.enumerable});return t},O=t=>to(Qi(ht(t!=null?Ki(zi(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t),rt=(t,e,r,n)=>{for(var i=n>1?void 0:n?Ke(e,r):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(n?s(e,r,i):s(i))||i);return n&&i&&ht(e,r,i),i};var er=w((du,tr)=>{var eo="Expected a function",Qe=0/0,ro="[object Symbol]",no=/^\s+|\s+$/g,io=/^[-+]0x[0-9a-f]+$/i,oo=/^0b[01]+$/i,so=/^0o[0-7]+$/i,ao=parseInt,co=typeof global=="object"&&global&&global.Object===Object&&global,uo=typeof self=="object"&&self&&self.Object===Object&&self,lo=co||uo||Function("return this")(),fo=Object.prototype,mo=fo.toString,po=Math.max,yo=Math.min,Se=function(){return lo.Date.now()};function ho(t,e,r){var n,i,o,s,a,u,p=0,c=!1,l=!1,m=!0;if(typeof t!="function")throw new TypeError(eo);e=Ze(e)||0,xe(r)&&(c=!!r.leading,l="maxWait"in r,o=l?po(Ze(r.maxWait)||0,e):o,m="trailing"in r?!!r.trailing:m);function f(h){var F=n,d=i;return n=i=void 0,p=h,s=t.apply(d,F),s}function y(h){return p=h,a=setTimeout(k,e),c?f(h):s}function x(h){var F=h-u,d=h-p,S=e-F;return l?yo(S,o-d):S}function v(h){var F=h-u,d=h-p;return u===void 0||F>=e||F<0||l&&d>=o}function k(){var h=Se();if(v(h))return j(h);a=setTimeout(k,x(h))}function j(h){return a=void 0,m&&n?f(h):(n=i=void 0,s)}function Z(){a!==void 0&&clearTimeout(a),p=0,n=u=i=a=void 0}function et(){return a===void 0?s:j(Se())}function Q(){var h=Se(),F=v(h);if(n=arguments,i=this,u=h,F){if(a===void 0)return y(u);if(l)return a=setTimeout(k,e),f(u)}return a===void 0&&(a=setTimeout(k,e)),s}return Q.cancel=Z,Q.flush=et,Q}function xe(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function go(t){return!!t&&typeof t=="object"}function bo(t){return typeof t=="symbol"||go(t)&&mo.call(t)==ro}function Ze(t){if(typeof t=="number")return t;if(bo(t))return Qe;if(xe(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=xe(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(no,"");var r=oo.test(t);return r||so.test(t)?ao(t.slice(2),r?2:8):io.test(t)?Qe:+t}tr.exports=ho});var sr=w((pu,or)=>{var rr="Expected a function",nr=0/0,wo="[object Symbol]",vo=/^\s+|\s+$/g,So=/^[-+]0x[0-9a-f]+$/i,xo=/^0b[01]+$/i,Eo=/^0o[0-7]+$/i,ko=parseInt,Co=typeof global=="object"&&global&&global.Object===Object&&global,_o=typeof self=="object"&&self&&self.Object===Object&&self,Oo=Co||_o||Function("return this")(),jo=Object.prototype,Po=jo.toString,Fo=Math.max,To=Math.min,Ee=function(){return Oo.Date.now()};function qo(t,e,r){var n,i,o,s,a,u,p=0,c=!1,l=!1,m=!0;if(typeof t!="function")throw new TypeError(rr);e=ir(e)||0,ee(r)&&(c=!!r.leading,l="maxWait"in r,o=l?Fo(ir(r.maxWait)||0,e):o,m="trailing"in r?!!r.trailing:m);function f(h){var F=n,d=i;return n=i=void 0,p=h,s=t.apply(d,F),s}function y(h){return p=h,a=setTimeout(k,e),c?f(h):s}function x(h){var F=h-u,d=h-p,S=e-F;return l?To(S,o-d):S}function v(h){var F=h-u,d=h-p;return u===void 0||F>=e||F<0||l&&d>=o}function k(){var h=Ee();if(v(h))return j(h);a=setTimeout(k,x(h))}function j(h){return a=void 0,m&&n?f(h):(n=i=void 0,s)}function Z(){a!==void 0&&clearTimeout(a),p=0,n=u=i=a=void 0}function et(){return a===void 0?s:j(Ee())}function Q(){var h=Ee(),F=v(h);if(n=arguments,i=this,u=h,F){if(a===void 0)return y(u);if(l)return a=setTimeout(k,e),f(u)}return a===void 0&&(a=setTimeout(k,e)),s}return Q.cancel=Z,Q.flush=et,Q}function $o(t,e,r){var n=!0,i=!0;if(typeof t!="function")throw new TypeError(rr);return ee(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),qo(t,e,{leading:n,maxWait:e,trailing:i})}function ee(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function No(t){return!!t&&typeof t=="object"}function Io(t){return typeof t=="symbol"||No(t)&&Po.call(t)==wo}function ir(t){if(typeof t=="number")return t;if(Io(t))return nr;if(ee(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=ee(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(vo,"");var r=xo.test(t);return r||Eo.test(t)?ko(t.slice(2),r?2:8):So.test(t)?nr:+t}or.exports=$o});var fr=w((yu,lr)=>{var Do="Expected a function",ar=1/0,Ro=17976931348623157e292,cr=0/0,Mo="[object Symbol]",Lo=/^\s+|\s+$/g,Ao=/^[-+]0x[0-9a-f]+$/i,Wo=/^0b[01]+$/i,Bo=/^0o[0-7]+$/i,Jo=parseInt,Ho=Object.prototype,Go=Ho.toString;function Uo(t,e){var r;if(typeof e!="function")throw new TypeError(Do);return t=Vo(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=void 0),r}}function Yo(t){return Uo(2,t)}function ur(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Ko(t){return!!t&&typeof t=="object"}function Xo(t){return typeof t=="symbol"||Ko(t)&&Go.call(t)==Mo}function zo(t){if(!t)return t===0?t:0;if(t=Qo(t),t===ar||t===-ar){var e=t<0?-1:1;return e*Ro}return t===t?t:0}function Vo(t){var e=zo(t),r=e%1;return e===e?r?e-r:e:0}function Qo(t){if(typeof t=="number")return t;if(Xo(t))return cr;if(ur(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=ur(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(Lo,"");var r=Wo.test(t);return r||Bo.test(t)?Jo(t.slice(2),r?2:8):Ao.test(t)?cr:+t}lr.exports=Yo});var vr=w((hu,wr)=>{var Zo="Expected a function",mr="__lodash_hash_undefined__",ts="[object Function]",es="[object GeneratorFunction]",rs=/[\\^$.*+?()[\]{}|]/g,ns=/^\[object .+?Constructor\]$/,is=typeof global=="object"&&global&&global.Object===Object&&global,os=typeof self=="object"&&self&&self.Object===Object&&self,dr=is||os||Function("return this")();function ss(t,e){return t==null?void 0:t[e]}function as(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch(r){}return e}var cs=Array.prototype,us=Function.prototype,pr=Object.prototype,ke=dr["__core-js_shared__"],yr=function(){var t=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),hr=us.toString,Ce=pr.hasOwnProperty,ls=pr.toString,fs=RegExp("^"+hr.call(Ce).replace(rs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ms=cs.splice,ds=gr(dr,"Map"),Bt=gr(Object,"create");function ft(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function ps(){this.__data__=Bt?Bt(null):{}}function ys(t){return this.has(t)&&delete this.__data__[t]}function hs(t){var e=this.__data__;if(Bt){var r=e[t];return r===mr?void 0:r}return Ce.call(e,t)?e[t]:void 0}function gs(t){var e=this.__data__;return Bt?e[t]!==void 0:Ce.call(e,t)}function bs(t,e){var r=this.__data__;return r[t]=Bt&&e===void 0?mr:e,this}ft.prototype.clear=ps;ft.prototype.delete=ys;ft.prototype.get=hs;ft.prototype.has=gs;ft.prototype.set=bs;function gt(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function ws(){this.__data__=[]}function vs(t){var e=this.__data__,r=re(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():ms.call(e,r,1),!0}function Ss(t){var e=this.__data__,r=re(e,t);return r<0?void 0:e[r][1]}function xs(t){return re(this.__data__,t)>-1}function Es(t,e){var r=this.__data__,n=re(r,t);return n<0?r.push([t,e]):r[n][1]=e,this}gt.prototype.clear=ws;gt.prototype.delete=vs;gt.prototype.get=Ss;gt.prototype.has=xs;gt.prototype.set=Es;function mt(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function ks(){this.__data__={hash:new ft,map:new(ds||gt),string:new ft}}function Cs(t){return ne(this,t).delete(t)}function _s(t){return ne(this,t).get(t)}function Os(t){return ne(this,t).has(t)}function js(t,e){return ne(this,t).set(t,e),this}mt.prototype.clear=ks;mt.prototype.delete=Cs;mt.prototype.get=_s;mt.prototype.has=Os;mt.prototype.set=js;function re(t,e){for(var r=t.length;r--;)if($s(t[r][0],e))return r;return-1}function Ps(t){if(!br(t)||Ts(t))return!1;var e=Ns(t)||as(t)?fs:ns;return e.test(qs(t))}function ne(t,e){var r=t.__data__;return Fs(e)?r[typeof e=="string"?"string":"hash"]:r.map}function gr(t,e){var r=ss(t,e);return Ps(r)?r:void 0}function Fs(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Ts(t){return!!yr&&yr in t}function qs(t){if(t!=null){try{return hr.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function _e(t,e){if(typeof t!="function"||e&&typeof e!="function")throw new TypeError(Zo);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=t.apply(this,n);return r.cache=o.set(i,s),s};return r.cache=new(_e.Cache||mt),r}_e.Cache=mt;function $s(t,e){return t===e||t!==t&&e!==e}function Ns(t){var e=br(t)?ls.call(t):"";return e==ts||e==es}function br(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}wr.exports=_e});var xr=w(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});function Is(t,e,r){let n=r.value;return r.value=function(...i){let o=performance.now(),s=n.apply(this,i),a=performance.now();return console.log(`Call to ${e} took ${(a-o).toFixed(2)} milliseconds.`),s},r}function Ds(t=0){return function(e,r,n){let i=n.value;return n.value=function(...o){setTimeout(()=>{i.apply(this,o)},t)},n}}var Rs=er();function Ms(t=0,e={}){return function(r,n,i){let o=new WeakMap,s=i.value;return i.value=function(...a){let u=o.get(this);u||(u=Rs(s,t,e).bind(this),o.set(this,u)),u(...a)},i}}var Ls=sr();function As(t=0,e={}){return function(r,n,i){let o=i.value;return i.value=Ls(o,t,e),i}}var Ws=fr();function Bs(t,e,r){let n=r.value;return r.value=Ws(n),r}function Js(t){return function(e){t.forEach(r=>{Object.getOwnPropertyNames(r.prototype).forEach(n=>{e.prototype[n]=r.prototype[n]})})}}var Hs=vr();function Gs(t){return function(e,r,n){return n.value=Hs(n.value,t),n}}function Us(t,e,r){let n=r.value;if(typeof n!="function")throw new Error(`@autobind decorator can only be applied to methods not: ${typeof n}`);let i=!1;return{configurable:!0,get(){if(i||this===t.prototype||this.hasOwnProperty(e)||typeof n!="function")return n;let o=n.bind(this);return i=!0,Object.defineProperty(this,e,{configurable:!0,get(){return o},set(s){n=s,delete this[e]}}),i=!1,o},set(o){n=o}}}var Sr=(t,e)=>t<e?-1:t>e?1:0;function Ys(t,e={isDescending:!0,type:"string"}){let r=Symbol();return function(n,i,o){Object.defineProperty(n,i,{set:function(a){if(!a||!Array.isArray(a))throw`Value of property ${i} is not a valid array!`;let u=e.type==="date";t?this[r]=a.sort(function(p,c){let l=u?new Date(p[t]):p[t],m=u?new Date(c[t]):c[t],f=Sr(l,m);return e.isDescending?f*-1:f}):this[r]=a.sort(function(p,c){let l=u?new Date(p):p,m=u?new Date(c):c,f=Sr(l,m);return e.isDescending?f*-1:f})},get:function(){return this[r]}})}}X.Mixin=Js;X.SortBy=Ys;X.bind=Us;X.debounce=Ms;X.delay=Ds;X.measure=Is;X.memo=Gs;X.once=Bs;X.throttle=As});var _r=w((xu,Cr)=>{Cr.exports={name:"bud.js",description:"\u26A1\uFE0F Lightning fast frontend build tools combining the best parts of Symfony Encore and Laravel Mix",logo:"https://cdn.roots.io/app/uploads/logo-bud.svg",card:"https://bud.js.org/img/bud.js.png",url:{discourse:"https://discourse.roots.io/c/bud/24",docs:"https://bud.js.org",git:"git@github.com:roots/bud",web:"https://github.com/roots/bud"},organization:{name:"Roots Software Foundation LLC",site:"https://roots.io",twitter:"https://twitter.com/rootswp",favicon:"https://roots.io/favicon.ico"},contributors:{kellymears:{type:["\u{1F680} steward","\u{1F4BB} dev","\u{1F4D5} docs"]},qwp6t:{type:["\u{1F680} steward","\u{1F4BB} dev","\u{1F4D5} docs"]},retlehs:{type:["\u{1F680} steward","\u{1F4D5} docs"]},swalkinshaw:{type:["\u{1F680} steward","\u{1F4BB} dev","\u{1F4D5} docs"]},joshuafredrickson:{type:["\u{1F4BB} dev","\u{1F4D5} docs"]},alwaysblank:{type:["\u{1F680} steward","\u{1F4D5} docs"]},alexdanylyschyn:{type:["\u{1F4BB} dev"]},clayrisser:{type:["\u{1F4D5} docs"]},catgofire:{type:["\u{1F4D5} docs"]},unlocdavid:{type:["\u{1F4D5} docs"]},robrecord:{type:["\u{1F4D5} docs"]}},sponsors:[{image:"https://cdn.roots.io/app/uploads/km-digital.svg",title:"KM Digital",url:"https://k-m.com/"},{image:"https://cdn.roots.io/app/uploads/carrot.svg",title:"Carrot",url:"https://carrot.com/"},{image:"https://cdn.roots.io/app/uploads/c21redwood.svg",title:"C21 Redwood Realty",url:"https://www.c21redwood.com/"},{image:"https://cdn.roots.io/app/uploads/wordpress.svg",title:"WordPress.com",url:"https://wordpress.com/"},{image:"https://cdn.roots.io/app/uploads/pantheon.svg",title:"Pantheon",url:"https://pantheon.io/"}],packages:{core:["@roots/bud","@roots/bud-api","@roots/bud-build","@roots/bud-cache","@roots/bud-compiler","@roots/bud-dashboard","@roots/bud-extensions","@roots/bud-framework","@roots/bud-hooks","@roots/bud-server"],extension:["@roots/bud-babel","@roots/bud-compress","@roots/bud-criticalcss","@roots/bud-emotion","@roots/bud-entrypoints","@roots/bud-esbuild","@roots/bud-eslint","@roots/bud-imagemin","@roots/bud-mdx","@roots/bud-postcss","@roots/bud-preset-recommend","@roots/bud-preset-wordpress","@roots/bud-prettier","@roots/bud-purgecss","@roots/bud-react","@roots/bud-sass","@roots/bud-solid","@roots/bud-stylelint","@roots/bud-swc","@roots/bud-tailwindcss","@roots/bud-terser","@roots/bud-typescript","@roots/bud-vue","@roots/bud-wordpress-dependencies","@roots/bud-wordpress-externals","@roots/bud-wordpress-manifests","@roots/sage"],library:["@roots/browserslist-config","@roots/bud-client","@roots/container","@roots/critical-css-webpack-plugin","@roots/dependencies","@roots/entrypoints-webpack-plugin","@roots/eslint-config","@roots/filesystem","@roots/merged-manifest-webpack-plugin","@roots/wordpress-dependencies-webpack-plugin","@roots/wordpress-externals-webpack-plugin","@roots/wordpress-hmr"]}}});var G=w(je=>{"use strict";je.fromCallback=function(t){return Object.defineProperty(function(...e){if(typeof e[e.length-1]=="function")t.apply(this,e);else return new Promise((r,n)=>{t.call(this,...e,(i,o)=>i!=null?n(i):r(o))})},"name",{value:t.name})};je.fromPromise=function(t){return Object.defineProperty(function(...e){let r=e[e.length-1];if(typeof r!="function")return t.apply(this,e);t.apply(this,e.slice(0,-1)).then(n=>r(null,n),r)},"name",{value:t.name})}});var Tr=w((Bu,Fr)=>{var ot=g("constants"),zs=process.cwd,oe=null,Vs=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return oe||(oe=zs.call(process)),oe};try{process.cwd()}catch(t){}typeof process.chdir=="function"&&(Pe=process.chdir,process.chdir=function(t){oe=null,Pe.call(process,t)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,Pe));var Pe;Fr.exports=Qs;function Qs(t){ot.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&e(t),t.lutimes||r(t),t.chown=o(t.chown),t.fchown=o(t.fchown),t.lchown=o(t.lchown),t.chmod=n(t.chmod),t.fchmod=n(t.fchmod),t.lchmod=n(t.lchmod),t.chownSync=s(t.chownSync),t.fchownSync=s(t.fchownSync),t.lchownSync=s(t.lchownSync),t.chmodSync=i(t.chmodSync),t.fchmodSync=i(t.fchmodSync),t.lchmodSync=i(t.lchmodSync),t.stat=a(t.stat),t.fstat=a(t.fstat),t.lstat=a(t.lstat),t.statSync=u(t.statSync),t.fstatSync=u(t.fstatSync),t.lstatSync=u(t.lstatSync),t.lchmod||(t.lchmod=function(c,l,m){m&&process.nextTick(m)},t.lchmodSync=function(){}),t.lchown||(t.lchown=function(c,l,m,f){f&&process.nextTick(f)},t.lchownSync=function(){}),Vs==="win32"&&(t.rename=function(c){return function(l,m,f){var y=Date.now(),x=0;c(l,m,function v(k){if(k&&(k.code==="EACCES"||k.code==="EPERM")&&Date.now()-y<6e4){setTimeout(function(){t.stat(m,function(j,Z){j&&j.code==="ENOENT"?c(l,m,v):f(k)})},x),x<100&&(x+=10);return}f&&f(k)})}}(t.rename)),t.read=function(c){function l(m,f,y,x,v,k){var j;if(k&&typeof k=="function"){var Z=0;j=function(et,Q,h){if(et&&et.code==="EAGAIN"&&Z<10)return Z++,c.call(t,m,f,y,x,v,j);k.apply(this,arguments)}}return c.call(t,m,f,y,x,v,j)}return Object.setPrototypeOf&&Object.setPrototypeOf(l,c),l}(t.read),t.readSync=function(c){return function(l,m,f,y,x){for(var v=0;;)try{return c.call(t,l,m,f,y,x)}catch(k){if(k.code==="EAGAIN"&&v<10){v++;continue}throw k}}}(t.readSync);function e(c){c.lchmod=function(l,m,f){c.open(l,ot.O_WRONLY|ot.O_SYMLINK,m,function(y,x){if(y){f&&f(y);return}c.fchmod(x,m,function(v){c.close(x,function(k){f&&f(v||k)})})})},c.lchmodSync=function(l,m){var f=c.openSync(l,ot.O_WRONLY|ot.O_SYMLINK,m),y=!0,x;try{x=c.fchmodSync(f,m),y=!1}finally{if(y)try{c.closeSync(f)}catch(v){}else c.closeSync(f)}return x}}function r(c){ot.hasOwnProperty("O_SYMLINK")?(c.lutimes=function(l,m,f,y){c.open(l,ot.O_SYMLINK,function(x,v){if(x){y&&y(x);return}c.futimes(v,m,f,function(k){c.close(v,function(j){y&&y(k||j)})})})},c.lutimesSync=function(l,m,f){var y=c.openSync(l,ot.O_SYMLINK),x,v=!0;try{x=c.futimesSync(y,m,f),v=!1}finally{if(v)try{c.closeSync(y)}catch(k){}else c.closeSync(y)}return x}):(c.lutimes=function(l,m,f,y){y&&process.nextTick(y)},c.lutimesSync=function(){})}function n(c){return c&&function(l,m,f){return c.call(t,l,m,function(y){p(y)&&(y=null),f&&f.apply(this,arguments)})}}function i(c){return c&&function(l,m){try{return c.call(t,l,m)}catch(f){if(!p(f))throw f}}}function o(c){return c&&function(l,m,f,y){return c.call(t,l,m,f,function(x){p(x)&&(x=null),y&&y.apply(this,arguments)})}}function s(c){return c&&function(l,m,f){try{return c.call(t,l,m,f)}catch(y){if(!p(y))throw y}}}function a(c){return c&&function(l,m,f){typeof m=="function"&&(f=m,m=null);function y(x,v){v&&(v.uid<0&&(v.uid+=4294967296),v.gid<0&&(v.gid+=4294967296)),f&&f.apply(this,arguments)}return m?c.call(t,l,m,y):c.call(t,l,y)}}function u(c){return c&&function(l,m){var f=m?c.call(t,l,m):c.call(t,l);return f&&(f.uid<0&&(f.uid+=4294967296),f.gid<0&&(f.gid+=4294967296)),f}}function p(c){if(!c||c.code==="ENOSYS")return!0;var l=!process.getuid||process.getuid()!==0;return!!(l&&(c.code==="EINVAL"||c.code==="EPERM"))}}});var Nr=w((Ju,$r)=>{var qr=g("stream").Stream;$r.exports=Zs;function Zs(t){return{ReadStream:e,WriteStream:r};function e(n,i){if(!(this instanceof e))return new e(n,i);qr.call(this);var o=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,i=i||{};for(var s=Object.keys(i),a=0,u=s.length;a<u;a++){var p=s[a];this[p]=i[p]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=Infinity;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){o._read()});return}t.open(this.path,this.flags,this.mode,function(c,l){if(c){o.emit("error",c),o.readable=!1;return}o.fd=l,o.emit("open",l),o._read()})}function r(n,i){if(!(this instanceof r))return new r(n,i);qr.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,i=i||{};for(var o=Object.keys(i),s=0,a=o.length;s<a;s++){var u=o[s];this[u]=i[u]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=t.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var Dr=w((Hu,Ir)=>{"use strict";Ir.exports=ea;var ta=Object.getPrototypeOf||function(t){return t.__proto__};function ea(t){if(t===null||typeof t!="object")return t;if(t instanceof Object)var e={__proto__:ta(t)};else var e=Object.create(null);return Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}});var W=w((Gu,qe)=>{var P=g("fs"),ra=Tr(),na=Nr(),ia=Dr(),se=g("util"),R,ae;typeof Symbol=="function"&&typeof Symbol.for=="function"?(R=Symbol.for("graceful-fs.queue"),ae=Symbol.for("graceful-fs.previous")):(R="___graceful-fs.queue",ae="___graceful-fs.previous");function oa(){}function Rr(t,e){Object.defineProperty(t,R,{get:function(){return e}})}var dt=oa;se.debuglog?dt=se.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(dt=function(){var t=se.format.apply(se,arguments);t="GFS4: "+t.split(/\n/).join(`
GFS4: `),console.error(t)});P[R]||(Mr=global[R]||[],Rr(P,Mr),P.close=function(t){function e(r,n){return t.call(P,r,function(i){i||Lr(),typeof n=="function"&&n.apply(this,arguments)})}return Object.defineProperty(e,ae,{value:t}),e}(P.close),P.closeSync=function(t){function e(r){t.apply(P,arguments),Lr()}return Object.defineProperty(e,ae,{value:t}),e}(P.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){dt(P[R]),g("assert").equal(P[R].length,0)}));var Mr;global[R]||Rr(global,P[R]);qe.exports=Fe(ia(P));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!P.__patched&&(qe.exports=Fe(P),P.__patched=!0);function Fe(t){ra(t),t.gracefulify=Fe,t.createReadStream=et,t.createWriteStream=Q;var e=t.readFile;t.readFile=r;function r(d,S,E){return typeof S=="function"&&(E=S,S=null),N(d,S,E);function N(I,D,T,A){return e(I,D,function(_){_&&(_.code==="EMFILE"||_.code==="ENFILE")?Et([N,[I,D,T],_,A||Date.now(),Date.now()]):typeof T=="function"&&T.apply(this,arguments)})}}var n=t.writeFile;t.writeFile=i;function i(d,S,E,N){return typeof E=="function"&&(N=E,E=null),I(d,S,E,N);function I(D,T,A,_,K){return n(D,T,A,function(q){q&&(q.code==="EMFILE"||q.code==="ENFILE")?Et([I,[D,T,A,_],q,K||Date.now(),Date.now()]):typeof _=="function"&&_.apply(this,arguments)})}}var o=t.appendFile;o&&(t.appendFile=s);function s(d,S,E,N){return typeof E=="function"&&(N=E,E=null),I(d,S,E,N);function I(D,T,A,_,K){return o(D,T,A,function(q){q&&(q.code==="EMFILE"||q.code==="ENFILE")?Et([I,[D,T,A,_],q,K||Date.now(),Date.now()]):typeof _=="function"&&_.apply(this,arguments)})}}var a=t.copyFile;a&&(t.copyFile=u);function u(d,S,E,N){return typeof E=="function"&&(N=E,E=0),I(d,S,E,N);function I(D,T,A,_,K){return a(D,T,A,function(q){q&&(q.code==="EMFILE"||q.code==="ENFILE")?Et([I,[D,T,A,_],q,K||Date.now(),Date.now()]):typeof _=="function"&&_.apply(this,arguments)})}}var p=t.readdir;t.readdir=c;function c(d,S,E){return typeof S=="function"&&(E=S,S=null),N(d,S,E);function N(I,D,T,A){return p(I,D,function(_,K){_&&(_.code==="EMFILE"||_.code==="ENFILE")?Et([N,[I,D,T],_,A||Date.now(),Date.now()]):(K&&K.sort&&K.sort(),typeof T=="function"&&T.call(this,_,K))})}}if(process.version.substr(0,4)==="v0.8"){var l=na(t);v=l.ReadStream,j=l.WriteStream}var m=t.ReadStream;m&&(v.prototype=Object.create(m.prototype),v.prototype.open=k);var f=t.WriteStream;f&&(j.prototype=Object.create(f.prototype),j.prototype.open=Z),Object.defineProperty(t,"ReadStream",{get:function(){return v},set:function(d){v=d},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WriteStream",{get:function(){return j},set:function(d){j=d},enumerable:!0,configurable:!0});var y=v;Object.defineProperty(t,"FileReadStream",{get:function(){return y},set:function(d){y=d},enumerable:!0,configurable:!0});var x=j;Object.defineProperty(t,"FileWriteStream",{get:function(){return x},set:function(d){x=d},enumerable:!0,configurable:!0});function v(d,S){return this instanceof v?(m.apply(this,arguments),this):v.apply(Object.create(v.prototype),arguments)}function k(){var d=this;F(d.path,d.flags,d.mode,function(S,E){S?(d.autoClose&&d.destroy(),d.emit("error",S)):(d.fd=E,d.emit("open",E),d.read())})}function j(d,S){return this instanceof j?(f.apply(this,arguments),this):j.apply(Object.create(j.prototype),arguments)}function Z(){var d=this;F(d.path,d.flags,d.mode,function(S,E){S?(d.destroy(),d.emit("error",S)):(d.fd=E,d.emit("open",E))})}function et(d,S){return new t.ReadStream(d,S)}function Q(d,S){return new t.WriteStream(d,S)}var h=t.open;t.open=F;function F(d,S,E,N){return typeof E=="function"&&(N=E,E=null),I(d,S,E,N);function I(D,T,A,_,K){return h(D,T,A,function(q,fu){q&&(q.code==="EMFILE"||q.code==="ENFILE")?Et([I,[D,T,A,_],q,K||Date.now(),Date.now()]):typeof _=="function"&&_.apply(this,arguments)})}}return t}function Et(t){dt("ENQUEUE",t[0].name,t[1]),P[R].push(t),Te()}var ce;function Lr(){for(var t=Date.now(),e=0;e<P[R].length;++e)P[R][e].length>2&&(P[R][e][3]=t,P[R][e][4]=t);Te()}function Te(){if(clearTimeout(ce),ce=void 0,P[R].length!==0){var t=P[R].shift(),e=t[0],r=t[1],n=t[2],i=t[3],o=t[4];if(i===void 0)dt("RETRY",e.name,r),e.apply(null,r);else if(Date.now()-i>=6e4){dt("TIMEOUT",e.name,r);var s=r.pop();typeof s=="function"&&s.call(null,n)}else{var a=Date.now()-o,u=Math.max(o-i,1),p=Math.min(u*1.2,100);a>=p?(dt("RETRY",e.name,r),e.apply(null,r.concat([i]))):P[R].push(t)}ce===void 0&&(ce=setTimeout(Te,0))}}});var pt=w(st=>{"use strict";var Ar=G().fromCallback,U=W(),sa=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(t=>typeof U[t]=="function");Object.assign(st,U);sa.forEach(t=>{st[t]=Ar(U[t])});st.exists=function(t,e){return typeof e=="function"?U.exists(t,e):new Promise(r=>U.exists(t,r))};st.read=function(t,e,r,n,i,o){return typeof o=="function"?U.read(t,e,r,n,i,o):new Promise((s,a)=>{U.read(t,e,r,n,i,(u,p,c)=>{if(u)return a(u);s({bytesRead:p,buffer:c})})})};st.write=function(t,e,...r){return typeof r[r.length-1]=="function"?U.write(t,e,...r):new Promise((n,i)=>{U.write(t,e,...r,(o,s,a)=>{if(o)return i(o);n({bytesWritten:s,buffer:a})})})};typeof U.writev=="function"&&(st.writev=function(t,e,...r){return typeof r[r.length-1]=="function"?U.writev(t,e,...r):new Promise((n,i)=>{U.writev(t,e,...r,(o,s,a)=>{if(o)return i(o);n({bytesWritten:s,buffers:a})})})});typeof U.realpath.native=="function"?st.realpath.native=Ar(U.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var Br=w((Yu,Wr)=>{"use strict";var aa=g("path");Wr.exports.checkPath=function(e){if(process.platform==="win32"&&/[<>:"|?*]/.test(e.replace(aa.parse(e).root,""))){let n=new Error(`Path contains invalid characters: ${e}`);throw n.code="EINVAL",n}}});var Ur=w((Ku,$e)=>{"use strict";var Jr=pt(),{checkPath:Hr}=Br(),Gr=t=>{let e={mode:511};return typeof t=="number"?t:J(J({},e),t).mode};$e.exports.makeDir=async(t,e)=>(Hr(t),Jr.mkdir(t,{mode:Gr(e),recursive:!0}));$e.exports.makeDirSync=(t,e)=>(Hr(t),Jr.mkdirSync(t,{mode:Gr(e),recursive:!0}))});var z=w((Xu,Yr)=>{"use strict";var ca=G().fromPromise,{makeDir:ua,makeDirSync:Ne}=Ur(),Ie=ca(ua);Yr.exports={mkdirs:Ie,mkdirsSync:Ne,mkdirp:Ie,mkdirpSync:Ne,ensureDir:Ie,ensureDirSync:Ne}});var at=w((zu,Xr)=>{"use strict";var la=G().fromPromise,Kr=pt();function fa(t){return Kr.access(t).then(()=>!0).catch(()=>!1)}Xr.exports={pathExists:la(fa),pathExistsSync:Kr.existsSync}});var De=w((Vu,zr)=>{"use strict";var kt=W();function ma(t,e,r,n){kt.open(t,"r+",(i,o)=>{if(i)return n(i);kt.futimes(o,e,r,s=>{kt.close(o,a=>{n&&n(s||a)})})})}function da(t,e,r){let n=kt.openSync(t,"r+");return kt.futimesSync(n,e,r),kt.closeSync(n)}zr.exports={utimesMillis:ma,utimesMillisSync:da}});var yt=w((Qu,Zr)=>{"use strict";var Ct=pt(),$=g("path"),pa=g("util");function ya(t,e,r){let n=r.dereference?i=>Ct.stat(i,{bigint:!0}):i=>Ct.lstat(i,{bigint:!0});return Promise.all([n(t),n(e).catch(i=>{if(i.code==="ENOENT")return null;throw i})]).then(([i,o])=>({srcStat:i,destStat:o}))}function ha(t,e,r){let n,i=r.dereference?s=>Ct.statSync(s,{bigint:!0}):s=>Ct.lstatSync(s,{bigint:!0}),o=i(t);try{n=i(e)}catch(s){if(s.code==="ENOENT")return{srcStat:o,destStat:null};throw s}return{srcStat:o,destStat:n}}function ga(t,e,r,n,i){pa.callbackify(ya)(t,e,n,(o,s)=>{if(o)return i(o);let{srcStat:a,destStat:u}=s;if(u){if(Ht(a,u)){let p=$.basename(t),c=$.basename(e);return r==="move"&&p!==c&&p.toLowerCase()===c.toLowerCase()?i(null,{srcStat:a,destStat:u,isChangingCase:!0}):i(new Error("Source and destination must not be the same."))}if(a.isDirectory()&&!u.isDirectory())return i(new Error(`Cannot overwrite non-directory '${e}' with directory '${t}'.`));if(!a.isDirectory()&&u.isDirectory())return i(new Error(`Cannot overwrite directory '${e}' with non-directory '${t}'.`))}return a.isDirectory()&&Re(t,e)?i(new Error(ue(t,e,r))):i(null,{srcStat:a,destStat:u})})}function ba(t,e,r,n){let{srcStat:i,destStat:o}=ha(t,e,n);if(o){if(Ht(i,o)){let s=$.basename(t),a=$.basename(e);if(r==="move"&&s!==a&&s.toLowerCase()===a.toLowerCase())return{srcStat:i,destStat:o,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(i.isDirectory()&&!o.isDirectory())throw new Error(`Cannot overwrite non-directory '${e}' with directory '${t}'.`);if(!i.isDirectory()&&o.isDirectory())throw new Error(`Cannot overwrite directory '${e}' with non-directory '${t}'.`)}if(i.isDirectory()&&Re(t,e))throw new Error(ue(t,e,r));return{srcStat:i,destStat:o}}function Vr(t,e,r,n,i){let o=$.resolve($.dirname(t)),s=$.resolve($.dirname(r));if(s===o||s===$.parse(s).root)return i();Ct.stat(s,{bigint:!0},(a,u)=>a?a.code==="ENOENT"?i():i(a):Ht(e,u)?i(new Error(ue(t,r,n))):Vr(t,e,s,n,i))}function Qr(t,e,r,n){let i=$.resolve($.dirname(t)),o=$.resolve($.dirname(r));if(o===i||o===$.parse(o).root)return;let s;try{s=Ct.statSync(o,{bigint:!0})}catch(a){if(a.code==="ENOENT")return;throw a}if(Ht(e,s))throw new Error(ue(t,r,n));return Qr(t,e,o,n)}function Ht(t,e){return e.ino&&e.dev&&e.ino===t.ino&&e.dev===t.dev}function Re(t,e){let r=$.resolve(t).split($.sep).filter(i=>i),n=$.resolve(e).split($.sep).filter(i=>i);return r.reduce((i,o,s)=>i&&n[s]===o,!0)}function ue(t,e,r){return`Cannot ${r} '${t}' to a subdirectory of itself, '${e}'.`}Zr.exports={checkPaths:ga,checkPathsSync:ba,checkParentPaths:Vr,checkParentPathsSync:Qr,isSrcSubdir:Re,areIdentical:Ht}});var cn=w((Zu,an)=>{"use strict";var Y=W(),Gt=g("path"),wa=z().mkdirs,va=at().pathExists,Sa=De().utimesMillis,Ut=yt();function xa(t,e,r,n){typeof r=="function"&&!n?(n=r,r={}):typeof r=="function"&&(r={filter:r}),n=n||function(){},r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001"),Ut.checkPaths(t,e,"copy",r,(i,o)=>{if(i)return n(i);let{srcStat:s,destStat:a}=o;Ut.checkParentPaths(t,s,e,"copy",u=>u?n(u):r.filter?en(tn,a,t,e,r,n):tn(a,t,e,r,n))})}function tn(t,e,r,n,i){let o=Gt.dirname(r);va(o,(s,a)=>{if(s)return i(s);if(a)return le(t,e,r,n,i);wa(o,u=>u?i(u):le(t,e,r,n,i))})}function en(t,e,r,n,i,o){Promise.resolve(i.filter(r,n)).then(s=>s?t(e,r,n,i,o):o(),s=>o(s))}function Ea(t,e,r,n,i){return n.filter?en(le,t,e,r,n,i):le(t,e,r,n,i)}function le(t,e,r,n,i){(n.dereference?Y.stat:Y.lstat)(e,(s,a)=>s?i(s):a.isDirectory()?Fa(a,t,e,r,n,i):a.isFile()||a.isCharacterDevice()||a.isBlockDevice()?ka(a,t,e,r,n,i):a.isSymbolicLink()?$a(t,e,r,n,i):a.isSocket()?i(new Error(`Cannot copy a socket file: ${e}`)):a.isFIFO()?i(new Error(`Cannot copy a FIFO pipe: ${e}`)):i(new Error(`Unknown file: ${e}`)))}function ka(t,e,r,n,i,o){return e?Ca(t,r,n,i,o):rn(t,r,n,i,o)}function Ca(t,e,r,n,i){if(n.overwrite)Y.unlink(r,o=>o?i(o):rn(t,e,r,n,i));else return n.errorOnExist?i(new Error(`'${r}' already exists`)):i()}function rn(t,e,r,n,i){Y.copyFile(e,r,o=>o?i(o):n.preserveTimestamps?_a(t.mode,e,r,i):fe(r,t.mode,i))}function _a(t,e,r,n){return Oa(t)?ja(r,t,i=>i?n(i):nn(t,e,r,n)):nn(t,e,r,n)}function Oa(t){return(t&128)==0}function ja(t,e,r){return fe(t,e|128,r)}function nn(t,e,r,n){Pa(e,r,i=>i?n(i):fe(r,t,n))}function fe(t,e,r){return Y.chmod(t,e,r)}function Pa(t,e,r){Y.stat(t,(n,i)=>n?r(n):Sa(e,i.atime,i.mtime,r))}function Fa(t,e,r,n,i,o){return e?on(r,n,i,o):Ta(t.mode,r,n,i,o)}function Ta(t,e,r,n,i){Y.mkdir(r,o=>{if(o)return i(o);on(e,r,n,s=>s?i(s):fe(r,t,i))})}function on(t,e,r,n){Y.readdir(t,(i,o)=>i?n(i):sn(o,t,e,r,n))}function sn(t,e,r,n,i){let o=t.pop();return o?qa(t,o,e,r,n,i):i()}function qa(t,e,r,n,i,o){let s=Gt.join(r,e),a=Gt.join(n,e);Ut.checkPaths(s,a,"copy",i,(u,p)=>{if(u)return o(u);let{destStat:c}=p;Ea(c,s,a,i,l=>l?o(l):sn(t,r,n,i,o))})}function $a(t,e,r,n,i){Y.readlink(e,(o,s)=>{if(o)return i(o);if(n.dereference&&(s=Gt.resolve(process.cwd(),s)),t)Y.readlink(r,(a,u)=>a?a.code==="EINVAL"||a.code==="UNKNOWN"?Y.symlink(s,r,i):i(a):(n.dereference&&(u=Gt.resolve(process.cwd(),u)),Ut.isSrcSubdir(s,u)?i(new Error(`Cannot copy '${s}' to a subdirectory of itself, '${u}'.`)):t.isDirectory()&&Ut.isSrcSubdir(u,s)?i(new Error(`Cannot overwrite '${u}' with '${s}'.`)):Na(s,r,i)));else return Y.symlink(s,r,i)})}function Na(t,e,r){Y.unlink(e,n=>n?r(n):Y.symlink(t,e,r))}an.exports=xa});var dn=w((tl,mn)=>{"use strict";var L=W(),Yt=g("path"),Ia=z().mkdirsSync,Da=De().utimesMillisSync,Kt=yt();function Ra(t,e,r){typeof r=="function"&&(r={filter:r}),r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:n,destStat:i}=Kt.checkPathsSync(t,e,"copy",r);return Kt.checkParentPathsSync(t,n,e,"copy"),Ma(i,t,e,r)}function Ma(t,e,r,n){if(n.filter&&!n.filter(e,r))return;let i=Yt.dirname(r);return L.existsSync(i)||Ia(i),un(t,e,r,n)}function La(t,e,r,n){if(!(n.filter&&!n.filter(e,r)))return un(t,e,r,n)}function un(t,e,r,n){let o=(n.dereference?L.statSync:L.lstatSync)(e);if(o.isDirectory())return Ua(o,t,e,r,n);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return Aa(o,t,e,r,n);if(o.isSymbolicLink())return Xa(t,e,r,n);throw o.isSocket()?new Error(`Cannot copy a socket file: ${e}`):o.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${e}`):new Error(`Unknown file: ${e}`)}function Aa(t,e,r,n,i){return e?Wa(t,r,n,i):ln(t,r,n,i)}function Wa(t,e,r,n){if(n.overwrite)return L.unlinkSync(r),ln(t,e,r,n);if(n.errorOnExist)throw new Error(`'${r}' already exists`)}function ln(t,e,r,n){return L.copyFileSync(e,r),n.preserveTimestamps&&Ba(t.mode,e,r),Me(r,t.mode)}function Ba(t,e,r){return Ja(t)&&Ha(r,t),Ga(e,r)}function Ja(t){return(t&128)==0}function Ha(t,e){return Me(t,e|128)}function Me(t,e){return L.chmodSync(t,e)}function Ga(t,e){let r=L.statSync(t);return Da(e,r.atime,r.mtime)}function Ua(t,e,r,n,i){return e?fn(r,n,i):Ya(t.mode,r,n,i)}function Ya(t,e,r,n){return L.mkdirSync(r),fn(e,r,n),Me(r,t)}function fn(t,e,r){L.readdirSync(t).forEach(n=>Ka(n,t,e,r))}function Ka(t,e,r,n){let i=Yt.join(e,t),o=Yt.join(r,t),{destStat:s}=Kt.checkPathsSync(i,o,"copy",n);return La(s,i,o,n)}function Xa(t,e,r,n){let i=L.readlinkSync(e);if(n.dereference&&(i=Yt.resolve(process.cwd(),i)),t){let o;try{o=L.readlinkSync(r)}catch(s){if(s.code==="EINVAL"||s.code==="UNKNOWN")return L.symlinkSync(i,r);throw s}if(n.dereference&&(o=Yt.resolve(process.cwd(),o)),Kt.isSrcSubdir(i,o))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${o}'.`);if(L.statSync(r).isDirectory()&&Kt.isSrcSubdir(o,i))throw new Error(`Cannot overwrite '${o}' with '${i}'.`);return za(i,r)}else return L.symlinkSync(i,r)}function za(t,e){return L.unlinkSync(e),L.symlinkSync(t,e)}mn.exports=Ra});var me=w((el,pn)=>{"use strict";var Va=G().fromCallback;pn.exports={copy:Va(cn()),copySync:dn()}});var En=w((rl,xn)=>{"use strict";var yn=W(),hn=g("path"),C=g("assert"),Xt=process.platform==="win32";function gn(t){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(r=>{t[r]=t[r]||yn[r],r=r+"Sync",t[r]=t[r]||yn[r]}),t.maxBusyTries=t.maxBusyTries||3}function Le(t,e,r){let n=0;typeof e=="function"&&(r=e,e={}),C(t,"rimraf: missing path"),C.strictEqual(typeof t,"string","rimraf: path should be a string"),C.strictEqual(typeof r,"function","rimraf: callback function required"),C(e,"rimraf: invalid options argument provided"),C.strictEqual(typeof e,"object","rimraf: options should be object"),gn(e),bn(t,e,function i(o){if(o){if((o.code==="EBUSY"||o.code==="ENOTEMPTY"||o.code==="EPERM")&&n<e.maxBusyTries){n++;let s=n*100;return setTimeout(()=>bn(t,e,i),s)}o.code==="ENOENT"&&(o=null)}r(o)})}function bn(t,e,r){C(t),C(e),C(typeof r=="function"),e.lstat(t,(n,i)=>{if(n&&n.code==="ENOENT")return r(null);if(n&&n.code==="EPERM"&&Xt)return wn(t,e,n,r);if(i&&i.isDirectory())return de(t,e,n,r);e.unlink(t,o=>{if(o){if(o.code==="ENOENT")return r(null);if(o.code==="EPERM")return Xt?wn(t,e,o,r):de(t,e,o,r);if(o.code==="EISDIR")return de(t,e,o,r)}return r(o)})})}function wn(t,e,r,n){C(t),C(e),C(typeof n=="function"),e.chmod(t,438,i=>{i?n(i.code==="ENOENT"?null:r):e.stat(t,(o,s)=>{o?n(o.code==="ENOENT"?null:r):s.isDirectory()?de(t,e,r,n):e.unlink(t,n)})})}function vn(t,e,r){let n;C(t),C(e);try{e.chmodSync(t,438)}catch(i){if(i.code==="ENOENT")return;throw r}try{n=e.statSync(t)}catch(i){if(i.code==="ENOENT")return;throw r}n.isDirectory()?pe(t,e,r):e.unlinkSync(t)}function de(t,e,r,n){C(t),C(e),C(typeof n=="function"),e.rmdir(t,i=>{i&&(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")?Qa(t,e,n):i&&i.code==="ENOTDIR"?n(r):n(i)})}function Qa(t,e,r){C(t),C(e),C(typeof r=="function"),e.readdir(t,(n,i)=>{if(n)return r(n);let o=i.length,s;if(o===0)return e.rmdir(t,r);i.forEach(a=>{Le(hn.join(t,a),e,u=>{if(!s){if(u)return r(s=u);--o==0&&e.rmdir(t,r)}})})})}function Sn(t,e){let r;e=e||{},gn(e),C(t,"rimraf: missing path"),C.strictEqual(typeof t,"string","rimraf: path should be a string"),C(e,"rimraf: missing options"),C.strictEqual(typeof e,"object","rimraf: options should be object");try{r=e.lstatSync(t)}catch(n){if(n.code==="ENOENT")return;n.code==="EPERM"&&Xt&&vn(t,e,n)}try{r&&r.isDirectory()?pe(t,e,null):e.unlinkSync(t)}catch(n){if(n.code==="ENOENT")return;if(n.code==="EPERM")return Xt?vn(t,e,n):pe(t,e,n);if(n.code!=="EISDIR")throw n;pe(t,e,n)}}function pe(t,e,r){C(t),C(e);try{e.rmdirSync(t)}catch(n){if(n.code==="ENOTDIR")throw r;if(n.code==="ENOTEMPTY"||n.code==="EEXIST"||n.code==="EPERM")Za(t,e);else if(n.code!=="ENOENT")throw n}}function Za(t,e){if(C(t),C(e),e.readdirSync(t).forEach(r=>Sn(hn.join(t,r),e)),Xt){let r=Date.now();do try{return e.rmdirSync(t,e)}catch{}while(Date.now()-r<500)}else return e.rmdirSync(t,e)}xn.exports=Le;Le.sync=Sn});var zt=w((nl,Cn)=>{"use strict";var ye=W(),tc=G().fromCallback,kn=En();function ec(t,e){if(ye.rm)return ye.rm(t,{recursive:!0,force:!0},e);kn(t,e)}function rc(t){if(ye.rmSync)return ye.rmSync(t,{recursive:!0,force:!0});kn.sync(t)}Cn.exports={remove:tc(ec),removeSync:rc}});var $n=w((il,qn)=>{"use strict";var nc=G().fromPromise,_n=pt(),On=g("path"),jn=z(),Pn=zt(),Fn=nc(async function(e){let r;try{r=await _n.readdir(e)}catch{return jn.mkdirs(e)}return Promise.all(r.map(n=>Pn.remove(On.join(e,n))))});function Tn(t){let e;try{e=_n.readdirSync(t)}catch{return jn.mkdirsSync(t)}e.forEach(r=>{r=On.join(t,r),Pn.removeSync(r)})}qn.exports={emptyDirSync:Tn,emptydirSync:Tn,emptyDir:Fn,emptydir:Fn}});var Rn=w((ol,Dn)=>{"use strict";var ic=G().fromCallback,Nn=g("path"),ct=W(),In=z();function oc(t,e){function r(){ct.writeFile(t,"",n=>{if(n)return e(n);e()})}ct.stat(t,(n,i)=>{if(!n&&i.isFile())return e();let o=Nn.dirname(t);ct.stat(o,(s,a)=>{if(s)return s.code==="ENOENT"?In.mkdirs(o,u=>{if(u)return e(u);r()}):e(s);a.isDirectory()?r():ct.readdir(o,u=>{if(u)return e(u)})})})}function sc(t){let e;try{e=ct.statSync(t)}catch{}if(e&&e.isFile())return;let r=Nn.dirname(t);try{ct.statSync(r).isDirectory()||ct.readdirSync(r)}catch(n){if(n&&n.code==="ENOENT")In.mkdirsSync(r);else throw n}ct.writeFileSync(t,"")}Dn.exports={createFile:ic(oc),createFileSync:sc}});var Bn=w((sl,Wn)=>{"use strict";var ac=G().fromCallback,Mn=g("path"),ut=W(),Ln=z(),cc=at().pathExists,{areIdentical:An}=yt();function uc(t,e,r){function n(i,o){ut.link(i,o,s=>{if(s)return r(s);r(null)})}ut.lstat(e,(i,o)=>{ut.lstat(t,(s,a)=>{if(s)return s.message=s.message.replace("lstat","ensureLink"),r(s);if(o&&An(a,o))return r(null);let u=Mn.dirname(e);cc(u,(p,c)=>{if(p)return r(p);if(c)return n(t,e);Ln.mkdirs(u,l=>{if(l)return r(l);n(t,e)})})})})}function lc(t,e){let r;try{r=ut.lstatSync(e)}catch{}try{let o=ut.lstatSync(t);if(r&&An(o,r))return}catch(o){throw o.message=o.message.replace("lstat","ensureLink"),o}let n=Mn.dirname(e);return ut.existsSync(n)||Ln.mkdirsSync(n),ut.linkSync(t,e)}Wn.exports={createLink:ac(uc),createLinkSync:lc}});var Hn=w((al,Jn)=>{"use strict";var lt=g("path"),Vt=W(),fc=at().pathExists;function mc(t,e,r){if(lt.isAbsolute(t))return Vt.lstat(t,n=>n?(n.message=n.message.replace("lstat","ensureSymlink"),r(n)):r(null,{toCwd:t,toDst:t}));{let n=lt.dirname(e),i=lt.join(n,t);return fc(i,(o,s)=>o?r(o):s?r(null,{toCwd:i,toDst:t}):Vt.lstat(t,a=>a?(a.message=a.message.replace("lstat","ensureSymlink"),r(a)):r(null,{toCwd:t,toDst:lt.relative(n,t)})))}}function dc(t,e){let r;if(lt.isAbsolute(t)){if(r=Vt.existsSync(t),!r)throw new Error("absolute srcpath does not exist");return{toCwd:t,toDst:t}}else{let n=lt.dirname(e),i=lt.join(n,t);if(r=Vt.existsSync(i),r)return{toCwd:i,toDst:t};if(r=Vt.existsSync(t),!r)throw new Error("relative srcpath does not exist");return{toCwd:t,toDst:lt.relative(n,t)}}}Jn.exports={symlinkPaths:mc,symlinkPathsSync:dc}});var Yn=w((cl,Un)=>{"use strict";var Gn=W();function pc(t,e,r){if(r=typeof e=="function"?e:r,e=typeof e=="function"?!1:e,e)return r(null,e);Gn.lstat(t,(n,i)=>{if(n)return r(null,"file");e=i&&i.isDirectory()?"dir":"file",r(null,e)})}function yc(t,e){let r;if(e)return e;try{r=Gn.lstatSync(t)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}Un.exports={symlinkType:pc,symlinkTypeSync:yc}});var ei=w((ul,ti)=>{"use strict";var hc=G().fromCallback,Kn=g("path"),V=pt(),Xn=z(),gc=Xn.mkdirs,bc=Xn.mkdirsSync,zn=Hn(),wc=zn.symlinkPaths,vc=zn.symlinkPathsSync,Vn=Yn(),Sc=Vn.symlinkType,xc=Vn.symlinkTypeSync,Ec=at().pathExists,{areIdentical:Qn}=yt();function kc(t,e,r,n){n=typeof r=="function"?r:n,r=typeof r=="function"?!1:r,V.lstat(e,(i,o)=>{!i&&o.isSymbolicLink()?Promise.all([V.stat(t),V.stat(e)]).then(([s,a])=>{if(Qn(s,a))return n(null);Zn(t,e,r,n)}):Zn(t,e,r,n)})}function Zn(t,e,r,n){wc(t,e,(i,o)=>{if(i)return n(i);t=o.toDst,Sc(o.toCwd,r,(s,a)=>{if(s)return n(s);let u=Kn.dirname(e);Ec(u,(p,c)=>{if(p)return n(p);if(c)return V.symlink(t,e,a,n);gc(u,l=>{if(l)return n(l);V.symlink(t,e,a,n)})})})})}function Cc(t,e,r){let n;try{n=V.lstatSync(e)}catch{}if(n&&n.isSymbolicLink()){let a=V.statSync(t),u=V.statSync(e);if(Qn(a,u))return}let i=vc(t,e);t=i.toDst,r=xc(i.toCwd,r);let o=Kn.dirname(e);return V.existsSync(o)||bc(o),V.symlinkSync(t,e,r)}ti.exports={createSymlink:hc(kc),createSymlinkSync:Cc}});var ui=w((ll,ci)=>{"use strict";var{createFile:ri,createFileSync:ni}=Rn(),{createLink:ii,createLinkSync:oi}=Bn(),{createSymlink:si,createSymlinkSync:ai}=ei();ci.exports={createFile:ri,createFileSync:ni,ensureFile:ri,ensureFileSync:ni,createLink:ii,createLinkSync:oi,ensureLink:ii,ensureLinkSync:oi,createSymlink:si,createSymlinkSync:ai,ensureSymlink:si,ensureSymlinkSync:ai}});var he=w((fl,li)=>{function _c(t,{EOL:e=`
`,finalEOL:r=!0,replacer:n=null,spaces:i}={}){let o=r?e:"";return JSON.stringify(t,n,i).replace(/\n/g,e)+o}function Oc(t){return Buffer.isBuffer(t)&&(t=t.toString("utf8")),t.replace(/^\uFEFF/,"")}li.exports={stringify:_c,stripBom:Oc}});var pi=w((ml,di)=>{var _t;try{_t=W()}catch(t){_t=g("fs")}var ge=G(),{stringify:fi,stripBom:mi}=he();async function jc(t,e={}){typeof e=="string"&&(e={encoding:e});let r=e.fs||_t,n="throws"in e?e.throws:!0,i=await ge.fromCallback(r.readFile)(t,e);i=mi(i);let o;try{o=JSON.parse(i,e?e.reviver:null)}catch(s){if(n)throw s.message=`${t}: ${s.message}`,s;return null}return o}var Pc=ge.fromPromise(jc);function Fc(t,e={}){typeof e=="string"&&(e={encoding:e});let r=e.fs||_t,n="throws"in e?e.throws:!0;try{let i=r.readFileSync(t,e);return i=mi(i),JSON.parse(i,e.reviver)}catch(i){if(n)throw i.message=`${t}: ${i.message}`,i;return null}}async function Tc(t,e,r={}){let n=r.fs||_t,i=fi(e,r);await ge.fromCallback(n.writeFile)(t,i,r)}var qc=ge.fromPromise(Tc);function $c(t,e,r={}){let n=r.fs||_t,i=fi(e,r);return n.writeFileSync(t,i,r)}var Nc={readFile:Pc,readFileSync:Fc,writeFile:qc,writeFileSync:$c};di.exports=Nc});var hi=w((dl,yi)=>{"use strict";var be=pi();yi.exports={readJson:be.readFile,readJsonSync:be.readFileSync,writeJson:be.writeFile,writeJsonSync:be.writeFileSync}});var we=w((pl,wi)=>{"use strict";var Ic=G().fromCallback,Qt=W(),gi=g("path"),bi=z(),Dc=at().pathExists;function Rc(t,e,r,n){typeof r=="function"&&(n=r,r="utf8");let i=gi.dirname(t);Dc(i,(o,s)=>{if(o)return n(o);if(s)return Qt.writeFile(t,e,r,n);bi.mkdirs(i,a=>{if(a)return n(a);Qt.writeFile(t,e,r,n)})})}function Mc(t,...e){let r=gi.dirname(t);if(Qt.existsSync(r))return Qt.writeFileSync(t,...e);bi.mkdirsSync(r),Qt.writeFileSync(t,...e)}wi.exports={outputFile:Ic(Rc),outputFileSync:Mc}});var Si=w((yl,vi)=>{"use strict";var{stringify:Lc}=he(),{outputFile:Ac}=we();async function Wc(t,e,r={}){let n=Lc(e,r);await Ac(t,n,r)}vi.exports=Wc});var Ei=w((hl,xi)=>{"use strict";var{stringify:Bc}=he(),{outputFileSync:Jc}=we();function Hc(t,e,r){let n=Bc(e,r);Jc(t,n,r)}xi.exports=Hc});var Ci=w((gl,ki)=>{"use strict";var Gc=G().fromPromise,B=hi();B.outputJson=Gc(Si());B.outputJsonSync=Ei();B.outputJSON=B.outputJson;B.outputJSONSync=B.outputJsonSync;B.writeJSON=B.writeJson;B.writeJSONSync=B.writeJsonSync;B.readJSON=B.readJson;B.readJSONSync=B.readJsonSync;ki.exports=B});var Fi=w((bl,Pi)=>{"use strict";var Uc=W(),Ae=g("path"),Yc=me().copy,_i=zt().remove,Kc=z().mkdirp,Xc=at().pathExists,Oi=yt();function zc(t,e,r,n){typeof r=="function"&&(n=r,r={}),r=r||{};let i=r.overwrite||r.clobber||!1;Oi.checkPaths(t,e,"move",r,(o,s)=>{if(o)return n(o);let{srcStat:a,isChangingCase:u=!1}=s;Oi.checkParentPaths(t,a,e,"move",p=>{if(p)return n(p);if(Vc(e))return ji(t,e,i,u,n);Kc(Ae.dirname(e),c=>c?n(c):ji(t,e,i,u,n))})})}function Vc(t){let e=Ae.dirname(t);return Ae.parse(e).root===e}function ji(t,e,r,n,i){if(n)return We(t,e,r,i);if(r)return _i(e,o=>o?i(o):We(t,e,r,i));Xc(e,(o,s)=>o?i(o):s?i(new Error("dest already exists.")):We(t,e,r,i))}function We(t,e,r,n){Uc.rename(t,e,i=>i?i.code!=="EXDEV"?n(i):Qc(t,e,r,n):n())}function Qc(t,e,r,n){Yc(t,e,{overwrite:r,errorOnExist:!0},o=>o?n(o):_i(t,n))}Pi.exports=zc});var Ii=w((wl,Ni)=>{"use strict";var Ti=W(),Be=g("path"),Zc=me().copySync,qi=zt().removeSync,tu=z().mkdirpSync,$i=yt();function eu(t,e,r){r=r||{};let n=r.overwrite||r.clobber||!1,{srcStat:i,isChangingCase:o=!1}=$i.checkPathsSync(t,e,"move",r);return $i.checkParentPathsSync(t,i,e,"move"),ru(e)||tu(Be.dirname(e)),nu(t,e,n,o)}function ru(t){let e=Be.dirname(t);return Be.parse(e).root===e}function nu(t,e,r,n){if(n)return Je(t,e,r);if(r)return qi(e),Je(t,e,r);if(Ti.existsSync(e))throw new Error("dest already exists.");return Je(t,e,r)}function Je(t,e,r){try{Ti.renameSync(t,e)}catch(n){if(n.code!=="EXDEV")throw n;return iu(t,e,r)}}function iu(t,e,r){return Zc(t,e,{overwrite:r,errorOnExist:!0}),qi(t)}Ni.exports=eu});var Ri=w((vl,Di)=>{"use strict";var ou=G().fromCallback;Di.exports={move:ou(Fi()),moveSync:Ii()}});var Zt=w((Sl,Mi)=>{"use strict";Mi.exports=J(J(J(J(J(J(J(J(J(J({},pt()),me()),$n()),ui()),Ci()),z()),Ri()),we()),at()),zt())});var lu={};Zi(lu,{default:()=>uu});var Er=O(g("@yarnpkg/cli")),bt=O(g("@yarnpkg/core")),kr=O(g("@yarnpkg/shell")),nt=O(xr()),b=class extends Er.BaseCommand{async getManifest(){return await bt.Manifest.tryFind(this.context.cwd)}async getConfiguration(){return await bt.Configuration.find(this.context.cwd,this.context.plugins)}async getProject(){let e=await this.getConfiguration(),{project:r}=await bt.Project.find(e,this.context.cwd);return r}withPassthrough(e){return this.passthrough.length?this.passthrough.reduce((r,n)=>n?`${r} ${n}`:`${r}`,e):e}log(e){var n;let r=(n=this.name)!=null?n:"@bud";process.stdout.write(`[${r}] ${e}
`)}err(e){var n;let r=(n=this.name)!=null?n:"@bud";process.stderr.write(`[${r}] ${typeof e=="string"?e:e.message}
`),process.exit(1)}async $(...e){let r=await this.getProject();await Promise.all(e.map(async n=>{if(!!n){this.log(n);try{let i=await(0,kr.execute)(n,[],{cwd:r.cwd});if(i!==0)throw new Error(`${n} failed with code ${i}`)}catch(i){this.err(i)}}}))}};rt([nt.bind],b.prototype,"getManifest",1),rt([nt.bind],b.prototype,"getConfiguration",1),rt([nt.bind],b.prototype,"getProject",1),rt([nt.bind],b.prototype,"withPassthrough",1),rt([nt.bind],b.prototype,"log",1),rt([nt.bind],b.prototype,"err",1),rt([nt.bind],b.prototype,"$",1);var Jt=class extends b{async execute(){process.stdout.write(`    
 _               _
| |__  _   _  __| |
|  _ \\| | | |/ _  |
| |_) | |_| | (_| |
|_.__/ \\__._|\\__._|
`),Object.values(ie).filter(e=>e.usage).forEach(e=>{var r;(r=e.usage.examples)==null||r.forEach(([n,i])=>{process.stdout.write(`
[34m${i}[0m  ${n}
`)})})}};Jt.label="@bud",Jt.paths=[["@bud"]];var Or=O(g("module")),it=O(g("path")),tt={},H=((tt==null?void 0:tt.url)&&typeof tt.url!="undefined"?tt.url.replace("file:/",""):__dirname).split("sources/").shift(),Eu=(0,it.join)(H,"package.json"),ku=(0,it.join)(H,"storage");var Cu=(0,it.join)(H,"config","tsconfig.json");var M={root:H,config:(0,it.join)(H,"config"),sources:(0,it.join)(H,"sources"),tests:(0,it.join)(H,"tests"),mocks:(0,it.join)(H,"./storage/mocks")},jr;typeof(tt==null?void 0:tt.url)!="undefined"?jr=(0,Or.createRequire)(tt.url)("../../../config/monorepo.config.cjs"):jr=_r();var wt=class extends b{async execute(){try{await this.$("rm -rf **/.budfiles"),await this.$("rm -rf **/node_modules/*"),await this.$(`rm -rf ${M.sources}/@roots/*/lib/*`),await this.$(`rm -rf ${M.sources}/@roots/*/types/*`)}catch(e){}try{await this.$("rm -rf storage/packages/@roots/*"),await this.$("rm -rf storage/packages/npm/*"),await this.$("rm -rf storage/mocks/*")}catch(e){}}};wt.label="@bud clean",wt.paths=[["@bud","clean"]],wt.usage={category:"@bud",description:"clean project artifacts",examples:[["clean project artifacts","yarn @bud clean"]]};var Pr=O(g("clipanion")),Oe=O(g("path"));var Ks=(0,Oe.join)(M.config,"tsconfig.json"),Xs=(0,Oe.join)(M.sources,"@repo/compile-kit/src/cjs"),vt=class extends b{constructor(){super(...arguments);this.package=Pr.Option.String("package to transpile","all")}async execute(){await this.$(`yarn ts-node --project ${Ks} ${Xs} ${this.package}`)}};vt.label="@bud compile",vt.paths=[["@bud","compile"]],vt.usage={category:"@bud",description:"compile a package",details:"compiles package with vercel/ncc",examples:[["compile {package name}","yarn @bud compile @roots/bud-react"]]};var Ru=`${H}/sources/@repo/compile-kit/src/cjs @roots/bud-support`,St=class extends b{async execute(){await this.$("yarn @bud tsc"),await this.$("yarn @bud tsc --watch","yarn @bud test unit --verbose --watch","yarn @bud docs dev")}};St.label="@bud dev",St.paths=[["@bud","dev"]],St.usage={category:"@bud",description:"develop project code",examples:[["run tsc, docusaurus & jest in watch mode","yarn @bud dev"]]};var xt=class extends b{async execute(){await this.$("yarn workspace @repo/docs docusaurus start")}};xt.label="@bud docs dev",xt.paths=[["@bud","docs","dev"]],xt.usage={category:"@bud",description:"develop docs",examples:[["develop docs","yarn @bud docs dev"]]};var ve=O(g("clipanion")),Li=O(Zt());var Ot=class extends b{constructor(){super(...arguments);this.api=ve.Option.Boolean("-a,--api",!1,{description:"build api docs"});this.site=ve.Option.Boolean("-s,--site",!1,{description:"build site files"});this.readme=ve.Option.Boolean("-r,--readme",!1,{description:"build readme files"})}async execute(){let e=!this.site&&!this.readme&&!this.api;(e||this.api)&&await this.$("typedoc           --out ./sources/@repo/docs/content/dev/api           --tsconfig ./config/tsconfig.json           --entryPoints             ./sources/@roots/bud-framework/src/index.ts             ./sources/@roots/bud-framework/src/extension/index.ts             ./sources/@roots/bud-framework/src/methods/index.ts             ./sources/@roots/bud-framework/src/services/index.ts             ./sources/@roots/bud/src/index.ts             ./sources/@roots/bud/src/cli/index.ts             ./sources/@roots/bud-api/src/index.ts             ./sources/@roots/bud-build/src/index.ts             ./sources/@roots/bud-compiler/src/index.ts             ./sources/@roots/bud-hooks/src/index.ts             ./sources/@roots/bud-server/src/index.ts             ./sources/@roots/bud/src/index.ts             ./sources/@roots/sage/src/index.ts             ./sources/@roots/container/src/index.ts"),(e||this.site)&&(await this.$(`yarn node ${M.sources}/@repo/markdown-kit/compiled/cli-examples/index.js`),await this.$("yarn workspace @repo/docs run build"),await(0,Li.copy)(`${M.sources}/@repo/docs/content/dev/api`,`${M.sources}/@repo/docs/build/dev/api`,{overwrite:!0})),(e||this.readme)&&await this.$(`yarn node ${M.sources}/@repo/markdown-kit/compiled/readme/index.js`)}};Ot.label="@bud docs",Ot.paths=[["@bud","docs"]],Ot.usage={category:"@bud",description:"build docs and readme.",examples:[["build all","yarn @bud docs"],["build api documentation","yarn @bud docs --api"],["build api documentation and site files","yarn @bud docs --site"],["build readme files","yarn @bud docs --readme"]]};var Ai=O(g("clipanion"));var jt=class extends b{constructor(){super(...arguments);this.passthrough=Ai.Option.Proxy({name:"eslint options"})}async execute(){await this.$(this.withPassthrough('yarn eslint "./sources/@roots/*/src/**/*" --config ./config/eslint.config.cjs --ignore-path config/.eslintignore --no-error-on-unmatched-pattern'))}};jt.label="@bud lint",jt.paths=[["@bud","lint"]],jt.usage={category:"@bud",description:"run eslint",examples:[["run eslint","yarn @bud lint"]]};var Pt=class extends b{async execute(){await this.$("yarn syncpack list-mismatches --config ./config/syncpack.config.cjs")}};Pt.label="@bud lint dependencies",Pt.paths=[["@bud","lint","dependencies"]],Pt.usage={category:"@bud",description:"ensure packages are synced",examples:[["lint dependency versions","yarn @bud lint dependencies"]]};var Ft=class extends b{async execute(){await this.$("yarn workspaces foreach --no-private exec yarn run package-check")}};Ft.label="@bud lint exports",Ft.paths=[["@bud","lint","exports"]],Ft.usage={category:"@bud",description:"lint published package module exports",examples:[["lint package.json module exports","yarn @bud lint exports"]]};var Wi=O(g("clipanion"));var Tt=class extends b{constructor(){super(...arguments);this.fix=Wi.Option.Boolean("-f,--fix",!0,{description:"fix"})}async execute(){await this.$(`yarn prettier ./sources/@roots/*/src/**/* ${this.fix?"--write":"--check"} --config ./config/prettier.config.cjs --ignore-unknown --no-error-on-unmatched-pattern`)}};Tt.label="@bud lint format",Tt.paths=[["@bud","format"]],Tt.usage={category:"@bud",description:"Run coding style linters",examples:[["run prettier","yarn @bud format"],["run prettier (no fix)","yarn @bud format --no-fix"]]};var He=O(g("@yarnpkg/shell")),qt=O(Zt());var $t=class extends b{async execute(){try{await(0,qt.ensureFile)(`${process.cwd()}/storage/yarn.lock`),await(0,qt.ensureDir)(`${process.cwd()}/storage/mocks`),await(0,qt.remove)(`${process.cwd()}/storage/mocks`),this.log("integration tests directory cleaned")}catch(e){}await this.tryExecuting("npm",["install","--location=global","pm2","verdaccio"],{cwd:`${process.cwd()}/storage`}),this.log("made pm2 and verdaccio globally available"),await this.tryExecuting("pm2",["start","verdaccio","--","--config=./config/verdaccio/config.yaml"]),this.log("started verdaccio"),await this.tryExecuting("yarn",["config","set","unsafeHttpWhitelist","--json",'["0.0.0.0","localhost"]']),await this.tryExecuting("yarn",["config","set","npmPublishRegistry","http://0.0.0.0:4873"]),await this.tryExecuting("yarn",["config","set","npmRegistryServer","http://0.0.0.0:4873"]),await this.tryExecuting("yarn",["install"]),this.log("installed via registry"),await this.tryExecuting("yarn",["@bud","release","--tag","latest"]),this.log("released to registry")}async tryExecuting(e,r,n={}){try{await(0,He.execute)(e,r,n)}catch(i){console.error(i),console.info("bailing out \u{1F4A5}"),await(0,He.execute)("yarn",["@bud","registry","stop"])}}};$t.label="@bud registry start",$t.paths=[["@bud","registry","start"]],$t.usage={category:"@bud",description:"start verdaccio registry",examples:[["start verdaccio server on 4873","yarn @bud registry start"]]};var Nt=O(g("@yarnpkg/shell")),te=O(Zt());var It=class extends b{async execute(){try{await(0,Nt.execute)("pm2",["stop","verdaccio"]),this.log("registry stopped"),await(0,Nt.execute)("pm2",["delete","verdaccio"]),this.log("registry deleted")}catch(e){}try{await(0,Nt.execute)("yarn",["config","unset","unsafeHttpWhitelist"]),await(0,Nt.execute)("yarn",["config","unset","npmPublishRegistry"]),await(0,Nt.execute)("yarn",["config","unset","npmRegistryServer"])}catch(e){}try{await(0,te.ensureDir)(`${process.cwd()}/storage/mocks`),await(0,te.remove)(`${process.cwd()}/storage/mocks`),await(0,te.remove)(`${process.cwd()}/storage/yarn.lock`),this.log("filesystem cleaned")}catch(e){}}};It.label="@bud registry stop",It.paths=[["@bud","registry","stop"]],It.usage={category:"@bud",description:"stop verdaccio registry",examples:[["stop verdaccio server on 4873","yarn @bud registry stop"]]};var Ge=O(g("clipanion")),Dt=O(Zt()),Bi=O(g("semver"));var Rt=class extends b{constructor(){super(...arguments);this.version=Ge.Option.String("-v,--version",null,{description:"version"});this.tag=Ge.Option.String("-t,--tag",null,{description:"tag"})}isTaggedLatest(){return this.tag==="latest"}async execute(){await this.executeStep("preflight"),await this.executeStep("bump"),await this.executeStep("make"),await this.executeStep("publish")}async executeStep(e){try{if(!this[e])throw new Error(`${e} is not implemented`);await this[`${e}`]()}catch(r){this.err(`${e} failed: ${r.message}
`),this.err(r.stack),process.exit(1)}}async checkTagIsValid(){if(!this.tag){let[e]=(0,Bi.parse)(this.version).prerelease;this.tag=`${e!=null?e:"latest"}`}if(this.tag!=="latest"&&this.tag!=="next")throw new Error(`--tag [${this.tag}] must be 'latest' or 'next'`)}async wipeProxyDb(){try{this.log("Wiping previously published packages");let e=await(0,Dt.readJson)(`${H}/storage/.verdaccio-db.json`);e.list=[],await(0,Dt.writeJson)(`${H}/storage/.verdaccio-db.json`,e),await(0,Dt.emptyDir)(`${H}/storage/packages/@roots`)}catch(e){this.log("db/previously published packages could not be wiped.")}}async preflight(){await this.wipeProxyDb(),this.log("Installing"),await this.$("yarn install --immutable"),await this.checkTagIsValid()}async bump(){this.version&&await this.$(`yarn @bud version ${this.version}`)}async make(){await this.$("yarn @bud build")}async publish(){await this.$(`yarn workspaces foreach --no-private npm publish --access public --tag ${this.tag}`)}};Rt.label="@bud release",Rt.paths=[["@bud","release"]],Rt.usage={category:"@bud",description:"Do a release.",examples:[["Bump packages to x.y.z and publish","yarn @bud release --version x.y.z --tag latest"]]};var Ue=O(g("@yarnpkg/shell")),Ji=O(g("clipanion"));var Mt=class extends b{constructor(){super(...arguments);this.passthrough=Ji.Option.Proxy({name:"jest params"})}get isIntegration(){return!this.passthrough||this.passthrough.length===0||this.passthrough.filter(e=>e.includes("integration")).length>0}async execute(){var r;if(this.isIntegration&&await this.tryExecuting("yarn",["@bud","registry","start"]),await this.tryExecuting("yarn",["node","--experimental-vm-modules","./node_modules/.bin/jest","--config","./config/jest.config.js",...(r=this.passthrough)!=null?r:[]])!==0)throw new Error("\u274C test spec failed");await this.teardown()}async tryExecuting(e,r,n={}){try{let i=await(0,Ue.execute)(e,r,n);return i!==0&&await this.teardown(),i}catch(i){throw await this.teardown(),new Error(i)}}async teardown(){this.isIntegration&&await(0,Ue.execute)("yarn",["@bud","registry","stop"])}};Mt.label="@bud test",Mt.paths=[["@bud","test"]],Mt.usage={category:"@bud",description:"run tests",examples:[["run unit tests","yarn @bud test unit"],["run integration tests","yarn @bud test integration"]]};var Hi=O(g("clipanion")),Gi=O(g("path"));var Lt=class extends b{constructor(){super(...arguments);this.tsconfig=(0,Gi.join)(M.config,"tsconfig.json");this.passthrough=Hi.Option.Proxy({name:"tsc options"})}async execute(){await this.$(this.withPassthrough(`yarn tsc -b ${this.tsconfig}`))}};Lt.label="@bud tsc",Lt.paths=[["@bud","tsc"],["@bud","build"]],Lt.usage={category:"@bud",description:"Run the typescript compiler",examples:[["run the typescript compiler","yarn @bud tsc"],["run the typescript compiler in watch mode","yarn @bud tsc --watch"],["run the typescript compiler with forced rebuild (no incremental compilation)","yarn @bud tsc --force"]]};var Ui=O(g("clipanion")),Ye=O(g("path"));var su=(0,Ye.join)(M.config,"tsconfig.json"),au=(0,Ye.join)(M.sources,"@repo/compile-kit/src/vendor/index.ts"),At=class extends b{constructor(){super(...arguments);this.request=Ui.Option.Rest()}async execute(){await this.$(`yarn ts-node-esm --project ${su} ${au} ${this.request}`)}};At.label="@bud vendor",At.paths=[["@bud","vendor"]],At.usage={category:"@bud",description:"vendor a package"};var Yi=O(g("clipanion"));var Wt=class extends b{constructor(){super(...arguments);this.version=Yi.Option.String()}async execute(){if(!this.version){let{version:e}=await this.getManifest();this.version=e}await this.$(`yarn workspaces foreach --no-private package set version ${this.version}`)}};Wt.label="@bud version",Wt.paths=[["@bud","version"]],Wt.usage={category:"@bud",description:"bump version of public packages",examples:[["Bump packages to x.y.z","yarn @bud version x.y.z"]]};var ie={Bud:Jt,Clean:wt,Compile:vt,Dev:St,Docs:Ot,DocsDev:xt,Format:Tt,Lint:jt,LintDependencies:Pt,LintExports:Ft,RegistryStart:$t,RegistryStop:It,Release:Rt,Test:Mt,Tsc:Lt,Vendor:At,Version:Wt};var cu={hooks:{afterAllInstalled:()=>{process.stdout.write(`
What a great install, am I right?
`)}},commands:Object.values(ie)},uu=cu;return lu;})();
return plugin;
}
};
