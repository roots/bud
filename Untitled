import unified from 'unified';
import { remark } from 'remark';
import rehypeToReact from 'rehype-react';
import remarkToRehype from 'remark-rehype';
import parseMarkdown from 'remark-parse';
import githubFlavoredMarkdown from 'remark-gfm';
import stripMarkdown from 'strip-markdown';

export async function createMarkdownExcerpt(content: string) {
  const { contents: excerpt } = await remark()
    .use(parseMarkdown)
    .use(githubFlavoredMarkdown)
    .use(stripMarkdown)
    .process(content);

  const shortened = excerpt.toString().trim().substr(0, 240);

  return `${shortened}...`;
}